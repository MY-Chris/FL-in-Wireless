(federal) sr@MYlabtop:/mnt/c/Users/MaYuan/Desktop/federated-learning$ python main_fed.py --dataset mnist --iid --num_channels 1 --model cnn --epochs 50 --gpu -1 --schedule_policy A
CNNMnist(
  (conv1): Conv2d(1, 10, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(10, 20, kernel_size=(5, 5), stride=(1, 1))
  (conv2_drop): Dropout2d(p=0.5, inplace=False)
  (fc1): Linear(in_features=320, out_features=50, bias=True)
  (fc2): Linear(in_features=50, out_features=10, bias=True)
)
/home/sr/miniconda3/envs/federal/lib/python3.8/site-packages/torch/tensor.py:447: UserWarning: non-inplace resize is deprecated
  warnings.warn("non-inplace resize is deprecated")
Round   0, Average loss 2.306, Accuracy 9.4399995803833
Round   1, Average loss 2.285, Accuracy 14.34000015258789
Round   2, Average loss 2.263, Accuracy 19.920000076293945
Round   3, Average loss 2.240, Accuracy 24.469999313354492
Round   4, Average loss 2.210, Accuracy 27.170000076293945
Round   5, Average loss 2.178, Accuracy 30.6299991607666
Round   6, Average loss 2.147, Accuracy 32.97999954223633
Round   7, Average loss 2.131, Accuracy 32.599998474121094
Round   8, Average loss 2.103, Accuracy 35.220001220703125
Round   9, Average loss 2.074, Accuracy 38.0
Round  10, Average loss 2.044, Accuracy 39.29999923706055
Round  11, Average loss 2.025, Accuracy 41.439998626708984
Round  12, Average loss 1.998, Accuracy 45.02000045776367
Round  13, Average loss 1.971, Accuracy 49.66999816894531
Round  14, Average loss 1.942, Accuracy 51.33000183105469
Round  15, Average loss 1.916, Accuracy 54.56999969482422
Round  16, Average loss 1.890, Accuracy 57.040000915527344
Round  17, Average loss 1.871, Accuracy 57.90999984741211
Round  18, Average loss 1.846, Accuracy 58.79999923706055
Round  19, Average loss 1.821, Accuracy 61.459999084472656
Round  20, Average loss 1.794, Accuracy 63.040000915527344
Round  21, Average loss 1.759, Accuracy 64.87000274658203
Round  22, Average loss 1.728, Accuracy 66.51000213623047
Round  23, Average loss 1.707, Accuracy 69.05999755859375
Round  24, Average loss 1.686, Accuracy 69.3499984741211
Round  25, Average loss 1.664, Accuracy 71.44000244140625
Round  26, Average loss 1.656, Accuracy 72.25
Round  27, Average loss 1.625, Accuracy 73.0999984741211
Round  28, Average loss 1.597, Accuracy 74.45999908447266
Round  29, Average loss 1.576, Accuracy 76.83999633789062
Round  30, Average loss 1.554, Accuracy 77.79000091552734
Round  31, Average loss 1.531, Accuracy 77.93000030517578
Round  32, Average loss 1.509, Accuracy 78.37000274658203
Round  33, Average loss 1.491, Accuracy 79.37999725341797
Round  34, Average loss 1.470, Accuracy 80.19999694824219
Round  35, Average loss 1.449, Accuracy 80.69999694824219
Round  36, Average loss 1.430, Accuracy 80.94999694824219
Round  37, Average loss 1.408, Accuracy 81.12000274658203
Round  38, Average loss 1.383, Accuracy 81.80999755859375
Round  39, Average loss 1.364, Accuracy 82.12000274658203
Round  40, Average loss 1.347, Accuracy 82.7699966430664
Round  41, Average loss 1.315, Accuracy 83.44999694824219
Round  42, Average loss 1.296, Accuracy 83.91999816894531
Round  43, Average loss 1.258, Accuracy 84.58000183105469
Round  44, Average loss 1.229, Accuracy 84.87999725341797
Round  45, Average loss 1.200, Accuracy 85.01000213623047
Round  46, Average loss 1.182, Accuracy 85.79000091552734
Round  47, Average loss 1.157, Accuracy 86.33999633789062
Round  48, Average loss 1.151, Accuracy 86.36000061035156
Round  49, Average loss 1.131, Accuracy 86.62000274658203
Training accuracy: 85.41
Testing accuracy: 86.62
(federal) sr@MYlabtop:/mnt/c/Users/MaYuan/Desktop/federated-learning$ python main_fed.py --dataset mnist --iid --num_channels 1 --model cnn --epochs 50 --gpu -1 --schedule_policy B
CNNMnist(
  (conv1): Conv2d(1, 10, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(10, 20, kernel_size=(5, 5), stride=(1, 1))
  (conv2_drop): Dropout2d(p=0.5, inplace=False)
  (fc1): Linear(in_features=320, out_features=50, bias=True)
  (fc2): Linear(in_features=50, out_features=10, bias=True)
)
/home/sr/miniconda3/envs/federal/lib/python3.8/site-packages/torch/tensor.py:447: UserWarning: non-inplace resize is deprecated
  warnings.warn("non-inplace resize is deprecated")
Round   0, Average loss 2.301, Accuracy 11.489999771118164
Round   1, Average loss 2.297, Accuracy 12.770000457763672
Round   2, Average loss 2.295, Accuracy 12.739999771118164
Round   3, Average loss 2.286, Accuracy 14.829999923706055
Round   4, Average loss 2.275, Accuracy 15.710000038146973
Round   5, Average loss 2.272, Accuracy 15.069999694824219
Round   6, Average loss 2.265, Accuracy 17.049999237060547
Round   7, Average loss 2.248, Accuracy 18.079999923706055
Round   8, Average loss 2.234, Accuracy 23.43000030517578
Round   9, Average loss 2.225, Accuracy 24.920000076293945
Round  10, Average loss 2.211, Accuracy 25.729999542236328
Round  11, Average loss 2.205, Accuracy 27.56999969482422
Round  12, Average loss 2.196, Accuracy 30.3700008392334
Round  13, Average loss 2.194, Accuracy 30.25
Round  14, Average loss 2.185, Accuracy 32.18000030517578
Round  15, Average loss 2.165, Accuracy 37.04999923706055
Round  16, Average loss 2.150, Accuracy 40.150001525878906
Round  17, Average loss 2.143, Accuracy 41.36000061035156
Round  18, Average loss 2.132, Accuracy 41.970001220703125
Round  19, Average loss 2.119, Accuracy 44.220001220703125
Round  20, Average loss 2.103, Accuracy 47.279998779296875
Round  21, Average loss 2.097, Accuracy 48.869998931884766
Round  22, Average loss 2.092, Accuracy 50.47999954223633
Round  23, Average loss 2.077, Accuracy 52.7400016784668
Round  24, Average loss 2.052, Accuracy 59.869998931884766
Round  25, Average loss 2.031, Accuracy 62.209999084472656
Round  26, Average loss 2.027, Accuracy 62.7400016784668
Round  27, Average loss 2.012, Accuracy 65.9800033569336
Round  28, Average loss 1.998, Accuracy 68.54000091552734
Round  29, Average loss 1.984, Accuracy 69.58000183105469
Round  30, Average loss 1.968, Accuracy 71.02999877929688
Round  31, Average loss 1.953, Accuracy 72.97000122070312
Round  32, Average loss 1.942, Accuracy 72.80000305175781
Round  33, Average loss 1.939, Accuracy 72.37000274658203
Round  34, Average loss 1.930, Accuracy 73.22000122070312
Round  35, Average loss 1.915, Accuracy 73.93000030517578
Round  36, Average loss 1.907, Accuracy 75.22000122070312
Round  37, Average loss 1.903, Accuracy 74.86000061035156
Round  38, Average loss 1.892, Accuracy 76.44999694824219
Round  39, Average loss 1.888, Accuracy 76.16000366210938
Round  40, Average loss 1.874, Accuracy 76.52999877929688
Round  41, Average loss 1.872, Accuracy 77.04000091552734
Round  42, Average loss 1.866, Accuracy 76.83000183105469
Round  43, Average loss 1.858, Accuracy 77.3499984741211
Round  44, Average loss 1.849, Accuracy 77.38999938964844
Round  45, Average loss 1.837, Accuracy 77.93000030517578
Round  46, Average loss 1.828, Accuracy 78.66999816894531
Round  47, Average loss 1.817, Accuracy 78.7300033569336
Round  48, Average loss 1.807, Accuracy 78.94000244140625
Round  49, Average loss 1.798, Accuracy 79.02999877929688
Training accuracy: 78.70
Testing accuracy: 79.03
(federal) sr@MYlabtop:/mnt/c/Users/MaYuan/Desktop/federated-learning$ python main_fed.py --dataset mnist --iid --num_channels 1 --model cnn --epochs 50 --gpu -1 --schedule_policy D
CNNMnist(
  (conv1): Conv2d(1, 10, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(10, 20, kernel_size=(5, 5), stride=(1, 1))
  (conv2_drop): Dropout2d(p=0.5, inplace=False)
  (fc1): Linear(in_features=320, out_features=50, bias=True)
  (fc2): Linear(in_features=50, out_features=10, bias=True)
)
/home/sr/miniconda3/envs/federal/lib/python3.8/site-packages/torch/tensor.py:447: UserWarning: non-inplace resize is deprecated
  warnings.warn("non-inplace resize is deprecated")
Round   0, Average loss 2.294, Accuracy 13.0600004196167
Round   1, Average loss 2.280, Accuracy 13.979999542236328
Round   2, Average loss 2.263, Accuracy 25.170000076293945
Round   3, Average loss 2.240, Accuracy 27.25
Round   4, Average loss 2.216, Accuracy 23.440000534057617
Round   5, Average loss 2.187, Accuracy 31.969999313354492
Round   6, Average loss 2.162, Accuracy 35.33000183105469
Round   7, Average loss 2.125, Accuracy 44.79999923706055
Round   8, Average loss 2.095, Accuracy 49.150001525878906
Round   9, Average loss 2.061, Accuracy 51.150001525878906
Round  10, Average loss 2.016, Accuracy 53.95000076293945
Round  11, Average loss 1.976, Accuracy 53.939998626708984
Round  12, Average loss 1.944, Accuracy 55.27000045776367
Round  13, Average loss 1.908, Accuracy 59.189998626708984
Round  14, Average loss 1.869, Accuracy 60.27000045776367
Round  15, Average loss 1.834, Accuracy 60.709999084472656
Round  16, Average loss 1.802, Accuracy 62.61000061035156
Round  17, Average loss 1.770, Accuracy 64.81999969482422
Round  18, Average loss 1.728, Accuracy 66.26000213623047
Round  19, Average loss 1.685, Accuracy 67.5999984741211
Round  20, Average loss 1.646, Accuracy 68.58000183105469
Round  21, Average loss 1.617, Accuracy 68.48999786376953
Round  22, Average loss 1.581, Accuracy 69.56999969482422
Round  23, Average loss 1.548, Accuracy 70.48999786376953
Round  24, Average loss 1.500, Accuracy 74.38999938964844
Round  25, Average loss 1.446, Accuracy 76.33999633789062
Round  26, Average loss 1.388, Accuracy 75.33000183105469
Round  27, Average loss 1.346, Accuracy 76.3499984741211
Round  28, Average loss 1.316, Accuracy 78.36000061035156
Round  29, Average loss 1.272, Accuracy 79.48999786376953
Round  30, Average loss 1.237, Accuracy 80.55000305175781
Round  31, Average loss 1.181, Accuracy 81.66000366210938
Round  32, Average loss 1.146, Accuracy 82.33999633789062
Round  33, Average loss 1.124, Accuracy 82.80999755859375
Round  34, Average loss 1.101, Accuracy 83.33000183105469
Round  35, Average loss 1.067, Accuracy 83.62000274658203
Round  36, Average loss 1.050, Accuracy 83.91999816894531
Round  37, Average loss 1.034, Accuracy 84.23999786376953
Round  38, Average loss 1.016, Accuracy 84.16000366210938
Round  39, Average loss 0.987, Accuracy 84.79000091552734
Round  40, Average loss 0.955, Accuracy 85.36000061035156
Round  41, Average loss 0.941, Accuracy 85.91000366210938
Round  42, Average loss 0.919, Accuracy 86.4000015258789
Round  43, Average loss 0.898, Accuracy 86.41999816894531
Round  44, Average loss 0.869, Accuracy 87.19999694824219
Round  45, Average loss 0.848, Accuracy 87.37000274658203
Round  46, Average loss 0.827, Accuracy 87.25
Round  47, Average loss 0.822, Accuracy 87.79000091552734
Round  48, Average loss 0.804, Accuracy 87.93000030517578
Round  49, Average loss 0.783, Accuracy 88.27999877929688
Training accuracy: 87.30
Testing accuracy: 88.28
